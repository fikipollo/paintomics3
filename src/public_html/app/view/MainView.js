function MainView(){this.name="MainView";this.subviews={};this.currentView=null;this.getSubView=function(aViewName){return this.subviews[aViewName]};this.addMainView=function(aViewInstance){this.subviews[aViewInstance.getName()]=aViewInstance};this.setLoading=function(loading){this.getComponent().queryById("mainViewCenterPanel").setLoading(loading)};this.getLastJobView=function(){for(var i=5;i>0;i--){if(this.getSubView("PA_Step"+i+"JobView")!==undefined){return this.getSubView("PA_Step"+i+"JobView")}}return null};this.changeMainView=function(aViewName){var aView=null;var me=this;if(aViewName===""||me.currentView!==null&&me.currentView.getName()===aViewName){if(aViewName==="DM_MyDataListView"){me.currentView.updateContent()}return}else if(aViewName==="contactForm"){application.getController("DataManagementController").sendReportHandler();return}else if(this.subviews[aViewName]==null){if(aViewName==="paintPathways"){application.getController("JobController").showJobInstance(this.getLastJobView().getModel());return}else if(aViewName==="DM_MyDataListView"){aView=new DM_MyDataListView;aView.setController(application.getController("DataManagementController"));this.subviews[aViewName]=aView}else if(aViewName==="DM_MyDataUploadFilesPanel"){aView=new DM_MyDataUploadFilesPanel;aView.setController(application.getController("DataManagementController"));this.subviews[aViewName]=aView}else if(aViewName==="fromBEDtoGenes"){aView=new DM_Bed2GenesJobView;aView.setController(application.getController("JobController"));this.subviews[aViewName]=aView}else if(aViewName==="fromMiRNAtoGenes"){aView=new DM_miRNA2GenesJobView;aView.setController(application.getController("JobController"));this.subviews[aViewName]=aView}else{aView=new DM_MyDataSubmitJobPanel(aViewName,application.getController("DataManagementController"));this.subviews[aViewName]=aView}}aView=this.subviews[aViewName];if(me.currentView!==null){me.getComponent().queryById("mainViewCenterPanel").remove(me.currentView.getComponent(),false)}me.currentView=aView;me.getComponent().queryById("mainViewCenterPanel").add(aView.getComponent())};this.initComponent=function(){var me=this;var sessionInfoBar=new SessionInfoBar;sessionInfoBar.setController(application.getController("UserController"));sessionInfoBar.getComponent().updateLoginState();this.component=Ext.create("Ext.container.Viewport",{id:"mainView",border:false,defaults:{border:0},layout:"border",items:[{xtype:"box",cls:"toolbar mainTopToolbar",region:"north",html:'<div id="header">'+'  <img src="resources/images/paintomics_150x150.png" alt="Paintomics logo">'+'  <h1> PaintOmics 3<span style="font-size: 8px; margin-left:10px;">'+APP_VERSION+"</span></h1>"+"</div>"+'<a class="button btn-sm btn-right loggedOption" data-name="logout" id="logoutButton"><i class="fa fa-sign-out"></i> Log out</a>'},{xtype:"box",id:"lateralMenu",cls:"lateralMenu",region:"west",html:"<ul class='lateralMenu-body'>"+" <li class='menuOption loggedOption' ><i class='fa fa-cloud'></i>  Personal storage"+"  <ul class='submenu loggedOption'>"+"     <li class='menuOption' data-name='DM_MyDataListView'><i class='fa fa-file-text'></i>  My files and Jobs</li>"+"     <li class='menuOption' data-name='DM_MyDataUploadFilesPanel'><i class='fa fa-cloud-upload'></i>   Upload new files</li>"+" </ul></li>"+" <li class='menuOption loggedOption' ><i class='fa fa-rocket'></i>  Tools"+" <ul class='submenu loggedOption'>"+"     <li class='menuOption' data-name='paintPathways'><i class='fa fa-paint-brush'></i>  Paint pathways</li>"+"     <li class='menuOption' data-name='fromBEDtoGenes'><i class='fa fa-align-center'></i>   From Regions to Genes</li>"+"     <li class='menuOption' data-name='fromMiRNAtoGenes'><i class='fa fa-link'></i>   From miRNA to Genes</li>"+" </ul></li>"+" <li class='menuOption' ><i class='fa fa-info-circle'></i>  Resources"+" <ul class='submenu'>"+"     <li class='menuOption externalOption'><a href='http://paintomics.readthedocs.org/en/latest/' target='_blank'><i class='fa fa-book'></i>  Paintomics Documentation</a></li>"+"     <li class='menuOption externalOption'><a href='http://www.paintomics.org/' target='_blank'><i class='fa fa-external-link'></i>  PaintOmics 2</a></li>"+" </ul></li>"+" <li class='menuOption' ><i class='fa fa-paper-plane-o'></i>  Publications"+" <ul class='submenu'>"+"     <li class='menuOption externalOption' style='font-size: 9px;'><a href='http://bioinformatics.oxfordjournals.org/content/early/2010/11/23/bioinformatics.btq594' target='_blank'>García-Alcalde F, García-López F, Dopazo J, Conesa A. <b>Paintomics: a web based tool for the joint visualization of transcriptomics and metabolomics data</b>. <i>Bioinformatics</i> 2011 27(1): 137–139.</a><br><a href='resources/images/paintomics2-garcia-alcalde.bib' target='_blank'>BibTeX</a></li>"+" </ul></li>"+" <li class='menuOption'><i class='fa fa-envelope-o'></i>  Contact"+" <ul class='submenu'>"+"     <li class='menuOption' data-name='contactForm'><i class='fa fa-envelope-o'></i>  Contact by email</li>"+" </ul></li>"+"</ul>"},{xtype:"container",itemId:"mainViewCenterPanel",id:"mainViewCenterPanel",flex:1,region:"center",overflowY:"auto",style:"background-color:#f3f3f3;",defaults:{border:0},items:[]}],listeners:{boxready:function(){$("#logoutButton").click(function(){application.getController("UserController").signOutButtonClickHandler()});var loggedIn=Ext.util.Cookies.get("userID")!==null;if(loggedIn!==true){$(".loggedOption").remove();application.getController("UserController").signInLinkClickHandler()}else{}$(".submenu .menuOption:not(.externalOption)").click(function(){$(".menuOption.selected").removeClass("selected");$(this).parents(".menuOption").addClass("selected");me.changeMainView(this.getAttribute("data-name"))});$(".lateralMenu-body").children(".menuOption").each(function(){var me=this;$(this).hover(function(){$(this).children(".submenu").fadeIn(100)},function(){$(this).children(".submenu").fadeOut(0)})});if(Ext.util.Cookies.get("silence")!=null){console.log("Message already shown, ignoring.")}else{$.ajax({type:"POST",url:SERVER_URL_GET_MESSAGE,data:{message_type:"starting_message"},success:function(response){if(response.success===false){return}if(response.messageList.length>0){showInfoMessage("Welcome to PaintOmics 3!",{message:response.messageList[0].message_content,showButton:true})}},error:ajaxErrorHandler})}},resize:function(){if($("#mainViewCenterPanel").width()<1e3){$("#mainViewCenterPanel").addClass("mobileMode")}else{$("#mainViewCenterPanel").removeClass("mobileMode")}}}});return this.component}}MainView.prototype=new View;